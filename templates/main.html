<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ìŠ¤ë§ˆíŠ¸ ì°¨ê³  ì œì–´</title>

    <!-- MQTT / Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.2/mqttws31.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* ğŸ”¥ ë¼ì´íŠ¸ ëª¨ë“œ */
        body.light-mode {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: #f5f5f5;
            color: #222;

            /* ë¶€ë“œëŸ¬ìš´ í™”ë©´ ì „í™˜ */
            transition: background-color 0.6s ease, color 0.6s ease;
        }

        /* ğŸ”¥ ë‹¤í¬ ëª¨ë“œ */
        body.dark-mode {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: #111;
            color: #eee;

            /* ë¶€ë“œëŸ¬ìš´ í™”ë©´ ì „í™˜ */
            transition: background-color 0.6s ease, color 0.6s ease;
        }

        /* í˜ì´ì§€ ì „ì²´ */
        .wrap {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 16px 40px;
        }

        h1 {
            margin: 0 0 10px 0;
            font-size: 1.6rem;
        }

        /* ì¹´ë“œ ë°•ìŠ¤ */
        .card {
            background: #fff;
            border-radius: 10px;
            padding: 18px 20px;
            margin-bottom: 24px;

            /* ì€ì€í•œ ê·¸ë¦¼ì */
            box-shadow: 0 3px 10px rgba(0,0,0,0.06);
        }

        body.dark-mode .card {
            background: #1b1b1b;
            box-shadow: 0 3px 10px rgba(0,0,0,0.6);
        }

        /* ë²„íŠ¼ */
        button {
            border: none;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        body.light-mode button {
            background: #1976d2;
            color: #fff;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.dark-mode button {
            background: #1f6feb;
            color: #fff;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* ğŸ”¥ ì„¸ë ¨ëœ êµ¬ë¶„ì„  */
        .divider {
            height: 1px;
            width: 100%;
            margin: 18px 0;

            background: linear-gradient(to right,
                rgba(0,0,0,0.05),
                rgba(0,0,0,0.15),
                rgba(0,0,0,0.05)
            );

            box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }

        body.dark-mode .divider {
            background: linear-gradient(to right,
                rgba(255,255,255,0.05),
                rgba(255,255,255,0.2),
                rgba(255,255,255,0.05)
            );

            box-shadow: 0 1px 4px rgba(255,255,255,0.08);
        }

        /* ë ˆì´ì•„ì›ƒ */
        .status-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
        }

        .status-block {
            flex: 1;
            min-width: 260px;
        }

        #snapshot {
            max-width: 100%;
            border-radius: 6px;
            border: 1px solid #ddd;
        }

        /* ğŸ”¹ canvas ì§ì ‘ í¬ê¸° ê³ ì • */
        #multiChart {
            width: 350px !important;
            height: 300px !important;
        }
    </style>
</head>

<body class="light-mode">
    <div class="wrap">
        <h1>ìŠ¤ë§ˆíŠ¸ ì°¨ê³  ì œì–´ğŸ ğŸš—</h1>

        <!-- ê¸°ëŠ¥ 1: ì‹œìŠ¤í…œ ì œì–´ -->
        <div class="card">
            <h2>ì‹œìŠ¤í…œ ì œì–´âš™ï¸</h2>
            <button onclick="fetch('/start', {method: 'POST'})">ì‹œìŠ¤í…œ ì‹œì‘</button>
            <button onclick="fetch('/stop',  {method: 'POST'})">P(ì£¼ì°¨)</button>

            <div class="divider"></div>

            <p style="font-size:0.9rem; color:#666;">
                ì‹œìŠ¤í…œì„ ì‹œì‘í•˜ê±°ë‚˜ ì£¼ì°¨(P) ìƒíƒœë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>

        <!-- ê¸°ëŠ¥ 2: ì‚¬ì§„ + ì°¨íŠ¸ -->
        <div class="card">
            <h2>ìƒíƒœ ëª¨ë‹ˆí„°ë§ğŸ“Š</h2>

            <div class="status-row">
                <div class="status-block">
                    <h3>ìµœê·¼ ì´¬ì˜ ì‚¬ì§„ğŸ“¸</h3>
                    <img id="snapshot" src="/static/last_shot.jpg" alt="ìµœê·¼ ì´¬ì˜ ì‚¬ì§„">
                </div>

                <div class="status-block">
                    <h3>ì‹¤ì‹œê°„ ì˜¨ë„ğŸŒ¡ï¸ ìŠµë„ğŸ’§</h3>
                    <canvas id="multiChart"></canvas>
                </div>
            </div>

            <div class="divider"></div>

            <p style="font-size:0.9rem; color:#666;">
                ì„¼ì„œ ë°ì´í„°ëŠ” ë¼ì¦ˆë² ë¦¬íŒŒì´ì—ì„œ MQTTë¡œ ì‹¤ì‹œê°„ ì „ì†¡ë©ë‹ˆë‹¤.
            </p>
        </div>

    </div>

    <!-- ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="/static/myChart.js"></script>
    <script src="/static/mqttio.js"></script>
</body>
</html>

